---
title: "返回错误还是返回空"
date: 2021-12-23
lastmod: 2021-12-23
subtitle:    "不同类型查询，应该按不同标准返回"
description: "主要为查询类API内的结果返回"
author:      Jzhang
draft:		false
image:       "img/theme/go1.png"
tags:        ["代码设计"]
categories:  ["Tech"]
---

## 背景

最近在根据需求写http api，有一个查询接口，在实现的过程中，对于查询结果为空的情况是该返回查询成功，结果为空

还是返回一个错误码标识not found产生了疑惑。

## 分析

联想了下已有的查询类接口的返回，发现确实2类返回都有

比如传入指定uid，查询用户信息，在数据库内没该用户信息的时候，返回not found查询错误

还有一类传入商品类别，查询该类别下的所有商品信息，在该类别下商品为空时，正常返回，且结果为空。

思考了一下，发现这个问题跟查询目标以及返回目标类别有关系。

如果查询目标是一个指定的单个目标，那么当查询不到时，应该返回错误

如果查询目标是一类的多个目标，那么当查询不到时，应该返回正常，结果为空列表。

关于该如何返回，也有人有不同的看法

[“无结果”是否应该是RESTful响应中的错误](https://qastack.cn/software/358243/should-no-results-be-an-error-in-a-restful-response)

> 除了@Ewan的很好的答案：
>
> 如果查询是返回一组结果的查询，则在逻辑上，空集与一组或多组相同。一般来说，由于@Ewan指出的原因，将空集更改为错误的弊大于利，而且根本没有必要。
>
> 如果查询是查找并返回特定单例的类型（希望找到该单例，例如，按ID精确匹配），则在逻辑上适当的可能响应是未找到。

对该评论深表赞同。



## 结论

查询目标与结果是特定的目标的话，在查询不到时，应该为之设置对应的错误码，并返回错误码。

查询目标与结果是一系列同类型的列表的话，在查询不到时，应该正常返回，查询结果为空列表即可。

## 后续

[gorm如何处理查询为空](https://juejin.cn/post/6979915555939713054)

该篇文章内的 业务预期，对我来说，是新的思考角度。

即数据找不到在业务上是预期内的正常情况，还是预期外的异常情况？

例如：有个查询商品列表，

当展示列表为空的时候，我们期望知道，是该条件下确实没数据？还是由于数据库查询出问题了导致的结果为空？

